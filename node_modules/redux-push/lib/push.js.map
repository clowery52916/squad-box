{"version":3,"sources":["../src/push.js"],"names":["push","dispatch","getState","type","action","payload","Permission","request","message","visibility","config","pushConfig","document","visibilityState","create","next"],"mappings":";;;;;;;;AAAA;;;;AACA;;AACA;;;;;;AAEA;;;;;AAKA,IAAMA,OAAO,SAAPA,IAAO;AAAA,QAAGC,QAAH,QAAGA,QAAH;AAAA,QAAaC,QAAb,QAAaA,QAAb;AAAA,WAA4B;AAAA,eAAQ,kBAAU;AAAA,gBAC/CC,IAD+C,GAC7BC,MAD6B,CAC/CD,IAD+C;AAAA,gBACzCE,OADyC,GAC7BD,MAD6B,CACzCC,OADyC;;;AAGvD,2BAASC,UAAT,CAAoBC,OAApB;;AAEA,oBAAQJ,IAAR;AACI;AAAA,wBACYK,OADZ,GACqDH,OADrD,CACYG,OADZ;AAAA,8CACqDH,OADrD,CACqBI,UADrB;AAAA,wBACqBA,UADrB,uCACkC,MADlC;AAAA,wBAC0CC,MAD1C,GACqDL,OADrD,CAC0CK,MAD1C;;;AAGI,wBAAMC,4CAECD,MAFD,CAAN;;AAKA;AACA,wBAAIE,SAASC,eAAT,KAA6B,QAA7B,IAAyCJ,eAAe,QAA5D,EAAsE;AAClE,uCAASK,MAAT,CAAgBN,OAAhB,EAAyBG,UAAzB;AACH;;AAED;AACA,wBAAIC,SAASC,eAAT,KAA6B,QAA7B,IAAyCJ,eAAe,QAA5D,EAAsE;AAClE,uCAASK,MAAT,CAAgBN,OAAhB,EAAyBG,UAAzB;AACH;;AAED;AACA,wBAAIF,eAAe,MAAnB,EAA2B;AACvB,uCAASK,MAAT,CAAgBN,OAAhB,EAAyBG,UAAzB;AACH;;AAED;AACJ;AACI,2BAAOI,KAAKX,MAAL,CAAP;AA1BR;;AA6BA,mBAAOW,KAAKX,MAAL,CAAP;AACH,SAnCwC;AAAA,KAA5B;AAAA,CAAb;;kBAqCeJ,I","file":"push.js","sourcesContent":["import PushNote from \"push.js/bin/push\";\nimport { PUSH_SET } from \"./constants/push\";\nimport defaultConfig from \"./config\";\n\n/**\n * @param dispatch\n * @param getState\n * @constructor\n */\nconst push = ({ dispatch, getState }) => next => action => {\n    const { type, payload } = action;\n\n    PushNote.Permission.request();\n\n    switch (type) {\n        case PUSH_SET:\n            const { message, visibility = \"show\", config } = payload;\n\n            const pushConfig = {\n                ...defaultConfig,\n                ...config\n            };\n\n            //show when user is away\n            if (document.visibilityState === \"hidden\" && visibility === \"hidden\") {\n                PushNote.create(message, pushConfig);\n            }\n\n            //show when user is on page\n            if (document.visibilityState !== \"hidden\" && visibility === \"onPage\") {\n                PushNote.create(message, pushConfig);\n            }\n\n            //show when user is away or on page\n            if (visibility === \"show\") {\n                PushNote.create(message, pushConfig);\n            }\n\n            break;\n        default:\n            return next(action);\n    }\n\n    return next(action);\n};\n\nexport default push;\n"]}